{"version":3,"sources":["assets\\scripts\\josk.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nconst { ccclass, property } = cc._decorator;\n// js转ts轮盘操作方法\n@ccclass\nexport default class NewClass extends cc.Component {\n\n    @property\n    maxSpeed: number = 0;\n\n    joyStickBtn: cc.Node = null;\n\n    dir: any;\n\n    player: cc.Node;\n    onLoad() {\n        // 隐藏fps\n        cc.debug.setDisplayStats(false);\n\n        // 获取 joyStickBtn player\n        this.joyStickBtn = this.node.children[0];\n        this.player = cc.find('Canvas/zhujue')\n\n        // 玩家的移动方向\n        this.dir = cc.v2(0, 0);\n\n        // 触摸事件\n        this.node.on('touchstart', this.onTouchStart, this);\n        this.node.on('touchmove', this.onTouchMove, this);\n        this.node.on('touchend', this.onTouchEnd, this);\n        this.node.on('touchcancel', this.onTouchCancel, this);\n    }\n\n    onDestroy() {\n        // 触摸事件\n        this.node.off('touchstart', this.onTouchStart, this);\n        this.node.off('touchmove', this.onTouchMove, this);\n        this.node.off('touchend', this.onTouchEnd, this);\n        this.node.off('touchcancel', this.onTouchCancel, this);\n    }\n\n    onTouchStart(event) {\n        // 当触摸开始时，设置joyStickBtn的位置\n        let pos = this.node.convertToNodeSpaceAR(event.getLocation());\n        this.joyStickBtn.setPosition(pos);\n    }\n\n    onTouchMove(event) {\n        // 不断改变joyStickBtn的位置\n        let posDelta = event.getDelta();\n        this.joyStickBtn.setPosition(this.joyStickBtn.position.add(posDelta));\n\n        // 获取方向\n        this.dir = this.joyStickBtn.position.normalize();\n    }\n\n    onTouchEnd(event) {\n        // 重置\n        this.joyStickBtn.setPosition(cc.v2(0, 0));\n    }\n\n    onTouchCancel(event) {\n        // 重置\n        this.joyStickBtn.setPosition(cc.v2(0, 0));\n    }\n\n    update(dt) {\n        // 获取 ratio\n        let len = this.joyStickBtn.position.mag();\n        let maxLen = this.node.width / 2;\n        let ratio = len / maxLen;\n\n        // 在 joyStickPanel 内限制 joyStickBtn\n        if (ratio > 1) {\n            this.joyStickBtn.setPosition(this.joyStickBtn.position.div(ratio));\n        }\n\n        // 移动zhujue\n        let dis = this.dir.mul(this.maxSpeed * ratio);\n        this.player.setPosition(this.player.position.add(dis));\n\n        // 限制画布内的zhujue\n        if (this.player.x > this.player.parent.width / 2)\n            this.player.x = this.player.parent.width / 2;\n        else if (this.player.x < -this.player.parent.width / 2)\n            this.player.x = -this.player.parent.width / 2;\n\n        if (this.player.y > this.player.parent.height / 2)\n            this.player.y = this.player.parent.height / 2;\n        else if (this.player.y < -this.player.parent.height / 2)\n            this.player.y = -this.player.parent.height / 2;\n    }\n}\n"]}